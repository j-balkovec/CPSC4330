pyspark --v: 3.1.1

# ------------------------ Q1 ------------------------

	-- data-frame: DataFrame[id: int, name: string, state: string, enrollment: int, cost: int] 

# ----------------------------------------------------


# ------------------------ Q2 ------------------------

	-- records filtered due to invalid fields: 0 

# ----------------------------------------------------


# ------------------------ Q3 ------------------------

		-- number of records from CA: 768 

# ----------------------------------------------------


# ------------------------ Q4 ------------------------

		-- percentage of records with non-null enrollment: 90.33 %

# ----------------------------------------------------


# ------------------------ Q5 ------------------------

+--------------------+-----+
|                name| cost|
+--------------------+-----+
|L3 Commercial Tra...|95165|
|Aviator College o...|91532|
|Hallmark Institut...|68183|
|University of Chi...|67572|
| Harvey Mudd College|66627|
+--------------------+-----+
only showing top 5 rows

# ----------------------------------------------------


# ------------------------ Q6 ------------------------

+-----+-----+
|state|count|
+-----+-----+
|AK   |9    |
|AL   |96   |
|AR   |92   |
|AS   |1    |
|AZ   |134  |
|CA   |768  |
|CO   |125  |
|CT   |97   |
|DC   |25   |
|DE   |19   |
|FL   |441  |
|FM   |1    |
|GA   |182  |
|GU   |3    |
|HI   |25   |
|IA   |90   |
|ID   |41   |
|IL   |289  |
|IN   |171  |
|KS   |99   |
|KY   |105  |
|LA   |128  |
|MA   |195  |
|MD   |96   |
|ME   |41   |
|MH   |1    |
|MI   |210  |
|MN   |155  |
|MO   |190  |
|MP   |1    |
|MS   |65   |
|MT   |32   |
|NC   |205  |
|ND   |30   |
|NE   |51   |
|NH   |41   |
|NJ   |165  |
|NM   |51   |
|NV   |46   |
|NY   |468  |
|OH   |355  |
|OK   |149  |
|OR   |93   |
|PA   |405  |
|PR   |149  |
|PW   |1    |
|RI   |26   |
|SC   |110  |
|SD   |31   |
|TN   |185  |
|TX   |480  |
|UT   |80   |
|VA   |187  |
|VI   |2    |
|VT   |27   |
|WA   |127  |
|WI   |116  |
|WV   |75   |
|WY   |11   |
+-----+-----+

# ----------------------------------------------------


# ------------------------ Q7 ------------------------

+-----+---------------+
|state|sum(enrollment)|
+-----+---------------+
|AK   |20931          |
|AL   |244495         |
|AR   |129839         |
|AS   |1285           |
|AZ   |492336         |
|CA   |2289074        |
|CO   |263127         |
|CT   |162399         |
|DC   |49895          |
|DE   |46775          |
|FL   |921295         |
|FM   |2213           |
|GA   |434547         |
|GU   |5550           |
|HI   |52568          |
|IA   |197815         |
|ID   |86177          |
|IL   |566429         |
|IN   |323447         |
|KS   |159919         |
|KY   |189040         |
|LA   |195989         |
|MA   |360143         |
|MD   |277019         |
|ME   |54190          |
|MH   |989            |
|MI   |481356         |
|MN   |263790         |
|MO   |290929         |
|MP   |1118           |
|MS   |146204         |
|MT   |42945          |
|NC   |449235         |
|ND   |40471          |
|NE   |90847          |
|NH   |93276          |
|NJ   |355956         |
|NM   |101737         |
|NV   |98344          |
|NY   |980417         |
|OH   |512505         |
|OK   |186090         |
|OR   |190288         |
|PA   |587872         |
|PR   |220185         |
|PW   |619            |
|RI   |71361          |
|SC   |211404         |
|SD   |39891          |
|TN   |268907         |
|TX   |1288769        |
|UT   |237062         |
|VA   |425637         |
|VI   |2022           |
|VT   |33335          |
|WA   |256146         |
|WI   |271425         |
|WV   |116881         |
|WY   |23306          |
+-----+---------------+

# ----------------------------------------------------


# ------------------------ Q8 ------------------------

+-----+------------------+
|state|avg(enrollment)   |
+-----+------------------+
|AK   |2325.6666666666665|
|AL   |2747.1348314606744|
|AR   |1527.5176470588235|
|AS   |1285.0            |
|AZ   |3938.688          |
|CA   |3571.0982839313574|
|CO   |2268.3362068965516|
|CT   |1888.360465116279 |
|DC   |2771.9444444444443|
|DE   |2751.470588235294 |
|FL   |2386.7746113989638|
|FM   |2213.0            |
|GA   |2633.6181818181817|
|GU   |1850.0            |
|HI   |2285.5652173913045|
|IA   |2247.8977272727275|
|ID   |2101.878048780488 |
|IL   |2161.942748091603 |
|IN   |2546.8267716535433|
|KS   |1796.8426966292134|
|KY   |1909.4949494949494|
|LA   |1580.5564516129032|
|MA   |2069.787356321839 |
|MD   |3077.988888888889 |
|ME   |1464.5945945945946|
|MH   |989.0             |
|MI   |2689.1396648044692|
|MN   |2013.6641221374045|
|MO   |1616.2722222222221|
|MP   |1118.0            |
|MS   |2478.0338983050847|
|MT   |1431.5            |
|NC   |2402.3262032085563|
|ND   |1395.551724137931 |
|NE   |1816.94           |
|NH   |2454.6315789473683|
|NJ   |2296.490322580645 |
|NM   |2119.5208333333335|
|NV   |2185.4222222222224|
|NY   |2285.3543123543122|
|OH   |1507.3676470588234|
|OK   |1310.4929577464789|
|OR   |2114.311111111111 |
|PA   |1642.1005586592178|
|PR   |1550.5985915492959|
|PW   |619.0             |
|RI   |3102.6521739130435|
|SC   |2052.4660194174758|
|SD   |1329.7            |
|TN   |1536.6114285714286|
|TX   |2997.1372093023256|
|UT   |3160.826666666667 |
|VA   |2643.7080745341614|
|VI   |2022.0            |
|VT   |1449.3478260869565|
|WA   |2189.2820512820513|
|WI   |2536.6822429906542|
|WV   |1623.3472222222222|
|WY   |2118.7272727272725|
+-----+------------------+

# ----------------------------------------------------


# ------------------------ Q9 ------------------------

+------+----------+---------------+--------------------+
|    id|enrollment|enrollment-2017|      percent-change|
+------+----------+---------------+--------------------+
|100654|      4348|           4824|    10.9475620975161|
|100663|     11269|          12866|  14.171621261868845|
|100690|       308|            322|   4.545454545454546|
|100706|      5829|           6917|  18.665294218562362|
|100724|      4740|           4189| -11.624472573839663|
|100751|     31005|          32387|   4.457345589421061|
|100760|      1546|           1404|  -9.184993531694696|
|100812|      2904|           2801|  -3.546831955922865|
|100830|      4142|           4211|  1.6658619024625783|
|100858|     21551|          23391|   8.537886872998932|
|100937|      1346|           1283|  -4.680534918276375|
|101028|      1566|           1370|  -12.51596424010217|
|101073|       379|            389|   2.638522427440633|
|101116|       460|            369| -19.782608695652172|
|101143|      1528|           1365| -10.667539267015707|
|101161|      4372|           4101|  -6.198536139066789|
|101189|      2282|           2272|-0.43821209465381245|
|101240|      4613|           4349| -5.7229568610448736|
|101277|        91|             83|  -8.791208791208792|
|101286|      4173|           3836|  -8.075724898154805|
+------+----------+---------------+--------------------+
only showing top 20 rows

# ----------------------------------------------------


